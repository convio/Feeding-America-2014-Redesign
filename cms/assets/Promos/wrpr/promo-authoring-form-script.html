<script src="https://raw.githubusercontent.com/ractoon/jQuery-Text-Counter/master/textcounter.min.js"></script>
<script type="text/javascript">
  jQuery(document).ready(function($) {

    var $promoType = $('.promoType');
    var $promoTypeSelect = $('#promo_type');
    var $promoTitle = $('.promoTitle');
    var $promoFilename = $('.promoFilename');
    var $promoHeadline = $('.promoHeadline');
    var $promoDescription = $('.promoDescription');
    var $promoDate = $('.promoDate');
    var $promoConditionalGroup = $('.promoConditionalGroup');
    var $promoSection = $('.promoSection');
    var $promoGlobal = $('.promoGlobal');


    var $promoStructuredInstructions = $('.promoStructuredInstructions');
    var $promoImage = $('.promoImage');
    var $promoMobileImage = $('.promoMobileImage');
    var $promoBannerStyle = $('.promoBannerStyle');
    var $promoBackgroundImage = $('.promoBackgroundImage');
    var $promoBackgroundColor = $('.promoBackgroundColor');
    var $promoButtonColor = $('.promoButtonColor');
    var $promoButtonStyle = $('.promoButtonStyle');
    var $promoButtonLabel = $('.promoButtonLabel');
    var $promoLink = $('.promoLink');
    var $promoTemplate = $('.promoTemplate');
    var $promoTemplateSelect = $('#form-template');
    var $promoWrapper = $('.promoWrapper');

    var $footerPromoInstructions = $('.footerPromoInstructions');
    var $sidebarPromosInstructions = $('.sidebarPromoInstructions');
    var $bannerPromoInstructions = $('.bannerPromoInstructions');
    var $inlinePromoInstructions = $('.inlinePromoInstructions');
    var $interrupterPromoInstructions = $('.interrupterPromoInstructions');
    var $urgentBannerPromoInstructions = $('.urgentBannerPromoInstructions');
    var $homeEmailPromoInstructions = $('.homeEmailPromoInstructions');
    var $homeFactoidsPromoInstructions = $('.homeFactoidsPromoInstructions');
    var $promoBodyInstructions = $('.promoBodyInstructions');

    var $headline = $('#headline');
    var $subtitle = $('#form-description');
    var $buttonLabel = $('#action_button_label');

    var $countedInputs = $([$headline, $subtitle, $buttonLabel]);
    $countedInputs.textcounter({ type: 'character', 'counterText' : 'Characters Entered: ', });

    $.fn.extend({
      setTemplate: function(templateName) {
        var $options = $(this).find('option');
        var $option = $options.filter(function() {
          if($(this).text() == templateName) {
            return this;
          }
        });
        $options.removeAttr('selected');
        $option.attr('selected', 'selected');
      }
    });

    var hiddenDefaults = jQuery([$promoHeadline, $promoDescription, $promoConditionalGroup, $promoSection, $promoGlobal, $promoStructuredInstructions, $promoImage, $promoMobileImage, $promoBannerStyle, $promoBackgroundImage, $promoBackgroundColor, $promoButtonColor, $promoButtonStyle, $promoButtonLabel, $promoLink, $promoBodyInstructions, $footerPromoInstructions, $sidebarPromosInstructions, $bannerPromoInstructions, $inlinePromoInstructions, $interrupterPromoInstructions, $urgentBannerPromoInstructions, $homeEmailPromoInstructions, $homeFactoidsPromoInstructions]);


    if($promoTypeSelect.length > 0) {
      hiddenDefaults.each(function() { $(this).hide() });

      $promoTypeSelect.on('change', function() {
        hiddenDefaults.each(function() { $(this).hide() });
        var selectedType = $(this).find('option:selected').text();

        switch(selectedType) {
          case 'Contextual Sidebar Promo':
          case 'Second Sidebar Promo':
            var visibleFields = jQuery([$promoHeadline, $promoDescription, $promoConditionalGroup, $promoSection, $promoGlobal, $promoStructuredInstructions, $promoImage, $promoBackgroundImage, $promoBackgroundColor, $promoButtonColor, $promoButtonStyle, $promoButtonLabel, $promoLink, $promoBodyInstructions, $sidebarPromosInstructions]);
            visibleFields.each(function() { $(this).show(); });
            $promoTemplateSelect.setTemplate('Sidebar Promo');
            break;

          case 'Footer - Act / Share':
          case 'Footer - Give / Thanks':
          case 'Footer - Join / Learn':
            var visibleFields = jQuery([$promoHeadline, $promoDescription, $promoConditionalGroup, $promoSection, $promoGlobal, $promoStructuredInstructions, $promoImage, $promoButtonColor, $promoButtonStyle, $promoButtonLabel, $promoLink, $promoBodyInstructions, $footerPromoInstructions]);
            visibleFields.each(function() { $(this).show(); });
            $promoTemplateSelect.setTemplate('Footer Promo');
            break;

          case 'Homepage Email Sign Up':
            var visibleFields = jQuery([$promoHeadline, $promoDescription, $promoStructuredInstructions, $promoBackgroundImage, $promoBackgroundColor, $promoButtonColor, $promoButtonStyle, $promoButtonLabel, $promoLink, $promoConditionalGroup, $homeEmailPromoInstructions, $promoBodyInstructions]);
            visibleFields.each(function() { $(this).show(); });
            $promoTemplateSelect.setTemplate('Homepage Email Promo');
            break;

          case 'Homepage How We Work / Did You Know Factoid':
            var visibleFields = jQuery([$promoHeadline, $promoStructuredInstructions, $promoBackgroundImage, $promoBackgroundColor, $promoLink, $promoBodyInstructions, $homeFactoidsPromoInstructions]);
            visibleFields.each(function() { $(this).show(); });
            $promoTemplateSelect.setTemplate('Homepage Factoid Promo');
            break;

          case 'Inline Promo':
            var visibleFields = jQuery([$promoHeadline, $promoSection, $promoGlobal, $promoStructuredInstructions, $promoImage, $promoBackgroundImage, $promoBackgroundColor, $promoLink, $inlinePromoInstructions]);
            visibleFields.each(function() { $(this).show(); });
            $promoTemplateSelect.setTemplate('Inline Promo');
            break;

          case 'Interrupter':
            var visibleFields = jQuery([ $promoConditionalGroup, $promoSection, $promoGlobal, $promoStructuredInstructions, $promoImage, $promoBackgroundImage, $promoBodyInstructions, $interrupterPromoInstructions]);
            visibleFields.each(function() { $(this).show(); });
            $promoTemplateSelect.setTemplate('Interrupter Promo');
            break;

          case 'Top Urgent Alert Banner':
            var visibleFields = jQuery([$promoSection, $promoGlobal, $promoStructuredInstructions, $promoImage, $promoBackgroundColor, $promoBackgroundImage, $promoBodyInstructions, $urgentBannerPromoInstructions]);
            visibleFields.each(function() { $(this).show(); });
            $promoTemplateSelect.setTemplate('Alert Promo');
            break;

          case 'Full Width Banner':
            var visibleFields = jQuery([$promoHeadline, $promoDescription, $promoSection, $promoGlobal, $promoStructuredInstructions, $promoImage, $promoBannerStyle, $promoBackgroundColor, $promoBackgroundImage, $bannerPromoInstructions, $promoBodyInstructions, ]);
            visibleFields.each(function() { $(this).show(); });
            $promoTemplateSelect.setTemplate('Full Width Banner Promo');
            break;

        }
      });

      $promoTypeSelect.trigger('change');
    }



  });
</script>